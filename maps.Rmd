---
title: "maps"
author: "Sophia Zheng"
date: "12/9/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(fs)
library(sf)
library(janitor)
library(tigris)
library(gganimate)
library(tidyverse)

zhvi <- read_csv("clean-data/zhvi.csv")
```

```{r, cache=TRUE}
options(tigris_use_cache = TRUE)
dir_create("raw-data")

# getting shapefiles with zip codes using the tigris package for only 
# the regions represented in the zhvi dataset, found by looking at
# zhvi %>% distinct(zip_code) %>% arrange(zip_code)

nyc_shape <- zctas(starts_with = c("07", "08", "10", "11", "12", "18"), 
                   class = "sf") %>%
  clean_names() %>% 
  mutate(zip_code = as.numeric(zcta5ce10))
sf_shape <- zctas(starts_with = "94", class = "sf") %>%
  clean_names() %>% 
  mutate(zip_code = as.numeric(zcta5ce10))
sea_shape <- zctas(starts_with = "98", class = "sf") %>%
  clean_names() %>% 
  mutate(zip_code = as.numeric(zcta5ce10))

dir_delete("raw-data")
```


```{r}
zhvi_nyc_shape <- nyc_shape %>% 
  left_join(zhvi, by = c("zip_code"))

zhvi_nyc_shape <- zhvi_nyc_shape %>% 
  drop_na(date)

ggplot(zhvi_nyc_shape) +
  geom_sf(data = zhvi_nyc_shape, aes(fill = zhvi)) +
  transition_time(date)
```

